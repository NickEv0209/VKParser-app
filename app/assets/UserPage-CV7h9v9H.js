import{p as _,j as s,v as d,w as l,x as m,T as o,I as p,P as v,U as u,D as g,L as N,M as y,r as f}from"./index-D2LYDgrJ.js";import{b as E,S as C,a as k,E as A}from"./StarBorder-DXE1Stpt.js";const L=_(s.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),I=({product:e})=>{const r=d(),t=l(c=>c.products.products.find(h=>h.id===e.id)),a=(t==null?void 0:t.isChecked)??!1,n=()=>{r({type:v.PRODUCT_TOGGLE_ACTIVE,payload:e})};return s.jsxs("div",{className:a?"user__product-item user__product-item--checked":"user__product-item",children:[s.jsxs("div",{className:"user__product-info",children:[s.jsx("img",{src:e.image==="Нет изображения"?"https://brilliant24.ru/files/cat/template_01.png":e.image,className:"user__product-image"}),s.jsxs("div",{className:"user__product-title-block",children:[s.jsx("h2",{className:"user__product-title",children:e.title}),s.jsx("p",{className:"user__product-description",children:"Перейдите к товару чтобы узнать больше"})]})]}),s.jsxs("div",{className:"user__product-buttons",children:[s.jsx(m,{variant:"text",endIcon:s.jsx(E,{style:{transform:"Rotate(-90deg)"}}),className:"product__button",style:{color:"var(--main-color)"},children:s.jsx("a",{href:e.link,target:"_blank",style:{all:"unset"},children:"Перейти"})}),s.jsx(o,{title:"Отметить",placement:"top",arrow:!0,children:s.jsx(p,{onClick:n,children:a?s.jsx(C,{style:{color:"var(--main-color)"}}):s.jsx(k,{})})})]})]})},U=({products:e})=>e.length?s.jsx("div",{className:"user__products",children:e.map(r=>s.jsx(I,{product:r},r.id))}):s.jsx("div",{className:"user__products",children:s.jsx("h2",{className:"user__products--empty",children:"Товаров нет"})}),b=({user:e})=>{const r=d(),t=()=>{r({type:u.EXPAND_ACTIVE_USER,payload:e})};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:e.isActive?"user user--active":"user",onDoubleClick:t,children:[s.jsxs("div",{className:"user__info",children:[s.jsx("img",{src:e.avatar,className:"user__avatar"}),s.jsx("h2",{className:"user__name",children:e.name})]}),s.jsxs("div",{className:"user__buttons",children:[s.jsx(o,{title:"Перейти в сообщения",placement:"top",arrow:!0,children:s.jsx("a",{target:"_blank",href:e.link,style:{textDecoration:"none"},children:s.jsx(p,{children:s.jsx(A,{})})})}),s.jsx(o,{title:e.isActive?"Свернуть":"Развернуть",placement:"top",arrow:!0,children:s.jsx(p,{onClick:t,children:s.jsx(L,{style:e.isActive?{transform:"rotate(180deg)"}:{transform:"rotate(0deg)"}})})})]})]}),e.isActive&&s.jsx(U,{products:e.products})]})},D=()=>s.jsx(s.Fragment,{children:s.jsxs("div",{className:"user--load",children:[s.jsxs("div",{className:"user__info--load",children:[s.jsx("div",{className:"user__avatar--load"}),s.jsx("div",{className:"user__name--load"})]}),s.jsx("div",{className:"user__buttons--load"})]})}),T=({count:e})=>s.jsx("div",{className:"users",children:Array.from({length:e}).map((r,t)=>s.jsx(D,{},t))}),w=()=>{const e=d(),{headless:r,messagesCount:t,pageLink:a}=l(c=>c.setting),n=()=>{e({type:y.OPEN_MODAL,payload:{title:"Хотите обновить данные?",text:"Запустится парсинг страниц, пока данные не обновятся, можно продолжать работу.",btnOk:"Обновить",btnCancel:"Отмена",settings:{pageLink:a,messagesCount:t,headless:r}}})};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"products__not-search",children:[s.jsx("h2",{children:"Пользователи не найдены"}),s.jsx("br",{}),s.jsx(o,{title:"Обновить данные",placement:"right",arrow:!0,children:s.jsx("h3",{onClick:n,children:"Обновите данные"})}),s.jsx(g,{style:{margin:"5px"}}),s.jsxs("p",{children:["Убедитесь, что установлены правильные",s.jsx(o,{title:"Перейти в настройки",placement:"right",arrow:!0,children:s.jsx(N,{to:"/settings",style:{marginLeft:"5px",textDecoration:"none"},children:s.jsx("span",{children:"настройки"})})})]})]})})},P=()=>{const e=d();f.useEffect(()=>{e({type:u.FETCH_USER})},[e]);const{isError:r,isLoading:t,users:a}=l(i=>i.users),{query:n}=l(i=>i.search);if(console.log(a),r)return s.jsx("h1",{children:"Error"});if(t)return s.jsx(T,{count:10});const c=i=>n.trim()?i.filter(x=>x.name.toLowerCase().includes(n.trim().toLowerCase())):i,h=i=>s.jsx("div",{className:"users",children:i.map(x=>s.jsx(b,{user:x},x.id))}),j=c(a);return j.length?h(j):s.jsx(w,{})},O=()=>{const e=d(),r=()=>{e({type:u.EXPAND_ACTIVE_ALL})},t=()=>{e({type:u.EXPAND_CLOSE_ALL})},{isActive:a,users:n}=l(c=>c.users);return s.jsxs("div",{className:"user-page",children:[s.jsxs("div",{className:"user-page__title-block",children:[s.jsx("h1",{className:"user-page__title",children:"Список пользователей"}),a||n.some(c=>c.isActive)?s.jsx(m,{style:{color:"var(--main-color)"},onClick:t,children:"Свернуть все"}):s.jsx(m,{style:{color:"var(--main-color)"},onClick:r,children:"Развернуть все"})]}),s.jsx(P,{})]})};export{O as default};
